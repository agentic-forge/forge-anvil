#!/usr/bin/env bash

# Load environment variables from .env file if it exists
dotenv_if_exists

# Activate virtual environment
# Try uv first if pyproject.toml exists, otherwise use .venv directly
if [[ -f "pyproject.toml" ]] && command -v uv > /dev/null; then
    # Find the virtual environment created by uv
    VENV_PATH=$(uv venv --show-path 2>/dev/null || echo ".venv")
elif [[ -d ".venv" ]]; then
    # Use .venv directly if it exists
    VENV_PATH=".venv"
fi

if [[ -n "$VENV_PATH" ]] && [[ -d "$VENV_PATH" ]]; then
    export VIRTUAL_ENV="$VENV_PATH"
    PATH_add "$VIRTUAL_ENV/bin"
fi

# Add the project root to PYTHONPATH for local imports
export PYTHONPATH="$PWD:${PYTHONPATH:-}"

# Set development defaults
export PYTHONDONTWRITEBYTECODE=1
export PYTHONUNBUFFERED=1
